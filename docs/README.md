# EIA v1 ドキュメント

このディレクトリには、EIA (Efficient Image Archive) バージョン1フォーマットの完全なドキュメントが含まれています。

## ドキュメント

### [EIA v1 仕様書](./eia-v1-specification.md)
RFC 2119準拠の言語でEIA v1フォーマットを定義する正式な仕様書。本文書は以下をカバーします：

- **ファイル構造**: バイナリフォーマットレイアウトとマニフェスト構造
- **データタイプ**: マスターファイル、クロップファイル、およびそれらの関係
- **圧縮**: LZ4圧縮方法論とデータ構成
- **拡張**: メタデータと将来の拡張性のサポート
- **セキュリティ**: 検証要件とセキュリティ考慮事項

**対象読者**: フォーマット実装者、デコーダー/エンコーダー開発者、仕様レビューア

### [EIA v1 実装ガイド](./eia-v1-implementation-guide.md)
EIA v1エンコーダーとデコーダーの実装に関する実践的なガイダンス。本文書は以下を含みます：

- **エンコーディング戦略**: キーフレーム選択、差分エンコーディング、最適化技術
- **パフォーマンス**: 圧縮率、メモリ使用量、処理ガイドライン
- **統合**: WebとNode.jsの例、他フォーマットからの移行
- **デバッグ**: 診断ツール、パフォーマンス監視、トラブルシューティング

**対象読者**: ソフトウェア開発者、アプリケーション統合者、パフォーマンスエンジニア

## クイックリファレンス

### 主な機能
- **差分エンコーディング**: 変化が最小限の画像シーケンスの効率的な保存
- **LZ4圧縮**: 良好な圧縮率での高速圧縮/展開
- **ランダムアクセス**: 完全な展開なしでの任意フレームへの直接アクセス
- **複数フォーマット**: RGB24、RGBA32、DXT1テクスチャのサポート
- **拡張可能**: メタデータサポートと将来の拡張余地

### ファイルフォーマット概要
```
ファイル構造: [ヘッダー][マニフェスト][データブロック...]
ヘッダー形式: EIA^{json_manifest}$
圧縮:       画像データにLZ4
拡張子:     .eia（推奨）
```

### 典型的な使用例
- **スライドプレゼンテーション**: 典型的に80-94%のサイズ削減
- **UIスクリーンショット**: 反復要素の優秀な圧縮  
- **アニメーションシーケンス**: 効率的な差分エンコーディング
- **ドキュメント**: ステップバイステップの視覚ガイド

### パフォーマンス特性
- **圧縮**: コンテンツタイプに応じて0.2-0.8倍
- **速度**: 50スライド @ 1920×1080で2-5秒
- **メモリ**: エンコーディング中約2倍のピーク、ストリーミングデコード
- **アクセス**: キーフレームO(1)、差分フレームO(k)

## 実装状況

### リファレンス実装
リファレンス実装はこのコードベースで利用可能です：

| コンポーネント | 場所 | 状況 |
|---------------|------|------|
| エンコーダー | `src/lib/eia/compressEIAv1.ts` | ✅ 完了 |
| 型定義 | `src/_types/eia/v1.ts` | ✅ 完了 |
| クロップロジック | `src/lib/crop/cropImages.ts` | ✅ 完了 |
| 統合 | `src/lib/selectedFiles2EIA/` | ✅ 完了 |
| デコーダー | - | ⏳ 予定 |

### 互換性マトリックス

| プラットフォーム | エンコーダー | デコーダー | 備考 |
|-----------------|-------------|-----------|------|
| Node.js | ✅ | ⏳ | リファレンス実装 |
| ブラウザ | ✅ | ⏳ | Webワーカー経由 |
| VRChat | ⏳ | ✅ | https://github.com/o-tr/jp.ootr.ImageDeviceController |

## 始め方

### 実装者向け
1. [仕様書](./eia-v1-specification.md)を徹底的に読む
2. [実装ガイド](./eia-v1-implementation-guide.md)を確認する
3. `src/lib/eia/`のリファレンス実装を調査する
4. 提供された例とエッジケースでテストする

### 統合者向け
1. [実装ガイド](./eia-v1-implementation-guide.md)を確認する
2. あなたのプラットフォーム向けの統合例をチェックする
3. あなたの使用例でのパフォーマンス特性を考慮する
4. 他フォーマットからの場合は移行戦略を計画する

### 貢献者向け
1. 仕様と実装の両方を理解する
2. リファレンスコードの確立されたパターンに従う
3. 新機能やエッジケースにテストを追加する
4. 変更についてドキュメントを更新する

## バージョン履歴

### バージョン 1.0 (現在)
- 初期仕様リリース
- RGB24、RGBA32、DXT1フォーマットのサポート
- LZ4圧縮での差分エンコーディング
- メタデータ用ノート拡張

### 将来のバージョン (予定)
- マルチ解像度サポート
- 音声同期
- 拡張メタデータフォーマット
- パフォーマンス最適化

## 貢献

EIA v1仕様と実装への貢献を歓迎します：

1. **仕様の問題**: 明確化や改善についてissueを開く
2. **実装バグ**: リファレンス実装の問題を報告  
3. **パフォーマンス**: 最適化や代替アルゴリズムを提案
4. **拡張**: 互換性を維持しながら新機能を提案

## ライセンス

この仕様と実装はプロジェクトライセンスの下で利用可能です。詳細はメインプロジェクトのREADMEを参照してください。
